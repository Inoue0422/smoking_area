<%= render "shared/header" %>

<div id="map" style="height: 100%; width: 100%;"></div>
<button id="current-location">現在地に移動</button>

<script>
function initMap() {
  // マップの初期化
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 15
  });

  // ブラウザのGeolocation APIを使用してユーザーの現在地を取得
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };

      // マップにマーカーを設置
      var marker = new google.maps.Marker({
        position: pos,
        map: map
      });

      // マップの中心をユーザーの現在地に設定
      map.setCenter(pos);
    }, function() {
      handleLocationError(true, map.getCenter());
    });
  } else {
    // ブラウザがGeolocationをサポートしていない場合
    handleLocationError(false, map.getCenter());
  }
}

function handleLocationError(browserHasGeolocation, pos) {
  // エラーハンドリング（ユーザーの位置情報取得ができない場合など）
  console.log('Error: The Geolocation service failed.');
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBeeK0DGpwqrvXJDuvutcK1kHJjwV7YZZA&callback=initMap" async defer></script>

<%= render "shared/footer" %>